---
import BaseLayout from "../layouts/BaseLayout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import { site } from "../lib/site";

const formEndpoint = import.meta.env.PUBLIC_FORMSPREE_ENDPOINT;
const formAction = formEndpoint || `mailto:${site.email}`;
const formMethod = formEndpoint ? "POST" : "POST";
const formEncType = formEndpoint ? "application/x-www-form-urlencoded" : "text/plain";
---
<BaseLayout
  title="Contact | Clic COM"
  description="Parlez de votre projet marketing ou web. Réponse rapide avec plan d'action clair."
  breadcrumbs={[{ name: "Accueil", item: "/" }, { name: "Contact", item: "/contact/" }]}
>
  <Navbar current="/contact/" />
  <main class="mx-auto max-w-5xl px-6 py-16">
    <div class="space-y-4">
      <h1 class="text-4xl font-semibold text-ink">Contact</h1>
      <p class="text-lg text-black/70">
        Décrivez votre besoin, nous vous répondons rapidement avec un plan clair et un
        devis aligné sur vos objectifs.
      </p>
    </div>

    <div class="mt-10 grid gap-8 lg:grid-cols-[1.2fr,0.8fr]">
      <form
        class="rounded-3xl border border-black/10 bg-white p-6 shadow-soft"
        action={formAction}
        method={formMethod}
        enctype={formEncType}
      >
        <div class="grid gap-4 md:grid-cols-2">
          <label class="text-sm font-semibold">
            Nom
            <input
              class="mt-2 w-full rounded-xl border border-black/20 px-4 py-2"
              type="text"
              name="nom"
              required
            />
          </label>
          <label class="text-sm font-semibold">
            Email
            <input
              class="mt-2 w-full rounded-xl border border-black/20 px-4 py-2"
              type="email"
              name="email"
              required
            />
          </label>
          <label class="text-sm font-semibold">
            Téléphone (CH)
            <input
              class="mt-2 w-full rounded-xl border border-black/20 px-4 py-2"
              type="tel"
              name="telephone"
              pattern="[+0-9\s]{6,}"
              required
            />
          </label>
          <label class="text-sm font-semibold">
            Entreprise
            <input
              class="mt-2 w-full rounded-xl border border-black/20 px-4 py-2"
              type="text"
              name="entreprise"
            />
          </label>
        </div>
        <label class="mt-4 block text-sm font-semibold">
          Budget estimatif
          <select
            class="mt-2 w-full rounded-xl border border-black/20 px-4 py-2"
            name="budget"
            required
          >
            <option value="">Sélectionner</option>
            <option value="moins-5k">Moins de 5k CHF</option>
            <option value="5k-15k">5k – 15k CHF</option>
            <option value="15k-30k">15k – 30k CHF</option>
            <option value="30k-plus">30k+ CHF</option>
          </select>
        </label>
        <label class="mt-4 block text-sm font-semibold">
          Message
          <textarea
            class="mt-2 min-h-[160px] w-full rounded-xl border border-black/20 px-4 py-2"
            name="message"
            required
          ></textarea>
        </label>
        <p class="mt-4 text-xs text-black/60">
          {formEndpoint
            ? "Formulaire relié à un endpoint sécurisé."
            : "Le formulaire utilise un email direct (mailto). Vous pouvez aussi écrire à hello@clicom.ch."}
        </p>
        <button
          class="focus-ring mt-6 rounded-full bg-accent px-6 py-3 text-sm font-semibold text-white"
          type="submit"
          aria-label="Envoyer la demande"
        >
          Envoyer
        </button>
      </form>

      <aside class="rounded-3xl border border-black/10 bg-black/5 p-6">
        <h2 class="text-lg font-semibold text-ink">Coordonnées</h2>
        <div class="mt-4 text-sm text-black/70">
          <p>Email : <a class="text-accent underline" href={`mailto:${site.email}`}>{site.email}</a></p>
          <p>Téléphone : <a class="text-accent underline" href={`tel:${site.phone.replace(/\s+/g, "")}`}>{site.phone}</a></p>
          <p>Site : <a class="text-accent underline" href={site.url}>{site.url}</a></p>
          <div class="mt-4 rounded-2xl border border-black/10 bg-white p-4 text-xs">
            <p class="font-semibold text-ink">Bloc signature HTML</p>
            <p class="mt-2 text-black/60">
              À intégrer ici dès réception de la signature fournie par le client.
            </p>
          </div>
        </div>
      </aside>
    </div>
  </main>
  <Footer />
</BaseLayout>
