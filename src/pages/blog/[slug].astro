---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Navbar from "../../components/Navbar.astro";
import Footer from "../../components/Footer.astro";
import { getCollection } from "astro:content";
import { site } from "../../lib/site";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({ params: { slug: post.slug }, props: { post } }));
}

const { post } = Astro.props;
const jsonLd = [
  {
    "@context": "https://schema.org",
    "@type": "Article",
    headline: post.data.title,
    description: post.data.description,
    datePublished: post.data.pubDate,
    author: {
      "@type": "Organization",
      name: site.name,
    },
    url: `${site.url}/blog/${post.slug}/`,
  },
];
---
<BaseLayout
  title={`${post.data.title} | Blog Clic COM`}
  description={post.data.description}
  canonical={`${site.url}/blog/${post.slug}/`}
  breadcrumbs={[
    { name: "Accueil", item: "/" },
    { name: "Blog", item: "/blog/" },
    { name: post.data.title, item: `/blog/${post.slug}/` },
  ]}
  jsonLd={jsonLd}
>
  <Navbar current="/blog/" />
  <main class="mx-auto max-w-3xl px-6 py-16">
    <p class="text-xs font-semibold uppercase text-accent">{post.data.pubDate}</p>
    <h1 class="mt-2 text-4xl font-semibold text-ink">{post.data.title}</h1>
    <p class="mt-4 text-lg text-black/70">{post.data.description}</p>

    <article class="mt-10 space-y-4 text-sm leading-7 text-black/80">
      <post.Content />
    </article>

    <a class="mt-10 inline-flex text-sm font-semibold text-accent" href="/blog/">
      Retour au blog â†’
    </a>
  </main>
  <Footer />
</BaseLayout>
